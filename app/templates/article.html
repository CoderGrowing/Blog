{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for("static", filename="blog.css")}}">
{% endblock %}

{% block title %} 文章 {% endblock %}

{% block page_content %}
  <div class="blog-header">
    <h1 class="blog-title">CoderGrowing</h1>
    <p class="lead blog-description">随笔随心</p>
    <hr>
  </div>
    <div class="col-sm-9 blog-main">
    <div class="blog-post">
    <div>
      <a href="{{ url_for('.article', id=post.id, name=post.heading) }}" class="blog-post-title title-link-style">{{ post.heading }}</a>
      <p class="blog-post-meta">时间:{{ post.timestamp[0:16]}}</p>
      {% if post.body_html %}
        {{ post.body_html | safe }}
      {% else %}
        {{ post.body }}
      {% endif %}
    </div>
    </div><hr>
    {% if post.comments.count() == 0 %}
          <div class="alert alert-info">还没有评论哦，还不快来抢沙发~</div>
        {% else %}
          <div class="label label-primary">已有{{ post.comments.count() }}条评论</div>
        {% endif %}
    </div>
    <div class="col-sm-3">
      <div class="list-group">
        <p class="list-group-item active">
          最近文章
        </p>
         {% for po in limit_posts %}
           <a href="{{ url_for('.article', id=po.id, name=po.heading) }}" class="list-group-item title-link-style">{{ po.heading }}</a>
         {% endfor %}
      </div>
    </div>

      <div class="comment-border col-sm-9">
        <ul class="comments"  id="comment">
          {% for comment in comments %}
          <li class="comment">
            <div class="comment-content well">
              <img class="img-rounded profile-thumbnail" src="{{ comment.user.gravatar(size=40) }}">
              <span class="username"> {{ comment.user.username }} </span>
              <span class="time">{{ comment.timestamp[0:16] }}</span>
              <div class="comment-body row">
                {{ comment.body }}
                <div class="reply-comment">
				          <a data-toggle="collapse" data-parent="#accordion" class="label label-primary"
				            href="#{{ comment.id }}">回复</a>
                  <div id="{{ comment.id }}" class="collapse">
                    <form method="POST" action="{{ url_for('main.article', id=post.id, name=post.heading) }}">
                  <div>
            <textarea rows="9" cols="50"  class="form-control textarea" required="required"></textarea>
          </div>
          <br>
          <input type="submit" class="btn btn-lg-4 btn-primary" value="提交">
        </form>
                  </div>
		            </div>
              </div>
            </div>
          </li>
          {% endfor %}
        </ul>
          <p class="lead">来都来了，留下点什么再走呗~</p>
          <p class="label label-default">写下你的评论</p>
        <form method="POST" action="{{ url_for('main.article', id=post.id, name=post.heading) }}">
          <div>
            <textarea rows="9" cols="50"  class="form-control textarea" required="required"></textarea>
          </div>
          <br>
          <input type="submit" class="btn btn-lg-4 btn-primary" value="提交">
        </form>
      </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
{% endblock %}